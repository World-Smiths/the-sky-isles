{"_id":"O7BzfcLUujT0jtuI","name":"The Fiery Incantation","type":"script","author":"F0kLzvTSBVFNjohJ","img":"icons/svg/dice-target.svg","scope":"global","command":"const modes = [{\n        name: \"Default\",\n        file: \"\",\n        darkness: 0,\n        hideLights: true, \n    },\n    {\n        name: \"Incantation\",\n        file: \"-incantation-shadows\",\n        darkness: 0.25,\n        hideLights: false,\n    },\n    {\n        name: \"Incantation & Fire from Sethlok\",\n        file: \"-bakeneko-fight\",\n        darkness: 0.5,\n        hideLights: false,\n    },\n    {\n        name: \"Incantation & Fire from Sethlok and the yokai pheonix\",\n        file: \"-fight-golden-phoenix\",\n        darkness: 0.75,\n        hideLights: false,\n    }\n];\n\nconst d = new Dialog({\n    title: \"The Fiery Incantation\",\n    content: \"<p>The Monastery Courtyard map has four versions, which would you like to use?</p><select></select>\",\n    buttons: {},\n    render: html => {\n        const select = html[0].querySelector(\"select\");\n        modes.forEach(mode => {\n            const option = document.createElement(\"option\");\n            option.innerText = mode.name;\n            select.append(option);\n        });\n        select.value = \"\";\n\n        select.addEventListener(\"change\", async () => {\n            const mode = modes.find(mode => mode.name === select.value);\n            const scene = game.scenes.getName(\"The Fiery Incantation\");\n\n            const affectedLights = [\"cglpc6A25sXnT03J\", \"Zk99JqA9FN9NjvhT\", \"TnMKbuw3ccJRNcUK\", \"NVzJ5so3RadCI93Q\"];\n            const lightUpdates = affectedLights.map(id => {\n                return {\n                    _id: id,\n                    hidden: mode.hideLights,\n                }\n            });\n            await scene.updateEmbeddedDocuments(\"AmbientLight\", lightUpdates);\n\n            await scene.update({\n                darkness: mode.darkness,\n                img: \"worlds/the-sky-isles/scenes/backgrounds/the-fiery-incantation\" + mode.file + \".webp\"\n            });\n        });\n    }\n});\nd.render(true);","folder":null,"sort":0,"permission":{"default":0,"F0kLzvTSBVFNjohJ":3},"flags":{}}
